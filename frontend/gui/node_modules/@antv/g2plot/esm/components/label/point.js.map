{"version":3,"file":"point.js","sourceRoot":"","sources":["../../../src/components/label/point.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,YAAY,CAAC;AACrD,OAAO,EAAyB,OAAO,EAAE,MAAM,kBAAkB,CAAC;AAClE,OAAO,SAAS,EAAE,EAAE,sBAAsB,EAAE,MAAM,6BAA6B,CAAC;AAGhF;IAAiE,8BAAY;IAA7E;;IA0DA,CAAC;IAzDW,sCAAiB,GAA3B;QACU,IAAA,wBAAK,CAAgB;QACrB,IAAA,gBAAU,EAAV,+BAAU,CAAW;QAC7B,kBACE,OAAO,EAAE,CAAC,EACV,OAAO,EAAE,CAAC,IACP,KAAK,EACR;IACJ,CAAC;IAES,mCAAc,GAAxB;QACE,OAAO,IAAI,CAAC,4BAA4B,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;IACpD,CAAC;IAES,sCAAiB,GAA3B,UAA4B,OAAgB,EAAE,KAAa;QAA3D,iBA0BC;QAzBO,IAAA,iBAAmC,EAAjC,gBAAK,EAAE,wBAA0B,CAAC;QAC1C,IAAM,WAAW,GAAmB,GAAG,CAAC,OAAO,EAAE,mBAAmB,EAAE,EAAE,CAAC,CAAC;QAE1E,OAAO,GAAG,CAAC,WAAW,EAAE,UAAC,KAAK,EAAE,UAAU;;YACxC,IAAM,KAAK,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACnC,sCACK,KAAI,CAAC,WAAW,CAAC,KAAK,CAAC,KAC1B,IAAI,EAAE,SAAS;oBACb,CAAC,CAAC,SAAS,CACP,KAAK;wBAEH,GAAC,OAAO,IAAG,KAAK,CAAC,OAAO;wBACxB,eAAY,GAAE,KAAK;wBACnB,oBAAiB,GAAE,UAAU;wBAC7B,UAAO,UAAA;wBACP,eAAY,GAAE,KAAK;6BAErB,KAAK,CACN;oBACH,CAAC,CAAC,KAAK,EACT,SAAS,EAAE,QAAQ,EACnB,YAAY,EAAE,QAAQ,KACnB,KAAK,EACR;QACJ,CAAC,CAAC,CAAC;IACL,CAAC;IAES,6BAAQ,GAAlB,UAAmB,KAAmB;QACpC,OAAO,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;IACvD,CAAC;IAES,gCAAW,GAArB,UAAsB,KAAmB;QACvC,IAAM,GAAG,GAAG;YACV,CAAC,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;YAC7C,CAAC,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;SAC9C,CAAC;QACF,OAAO,GAAG,CAAC;IACb,CAAC;IAES,gCAAW,GAArB;QACE,OAAO;IACT,CAAC;IACH,iBAAC;AAAD,CAAC,AA1DD,CAAiE,SAAS,GA0DzE;;AAED,sBAAsB,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC","sourcesContent":["import { get, map, isArray, last } from '@antv/util';\nimport { Element, MappingDatum, _ORIGIN } from '../../dependents';\nimport BaseLabel, { registerLabelComponent } from '../../components/label/base';\nimport { TextStyle, Label } from '../../interface/config';\n\nexport default class PointLabel<L extends Label = Label> extends BaseLabel<L> {\n  protected getDefaultOptions() {\n    const { theme } = this.layer;\n    const { label = {} } = theme;\n    return {\n      offsetX: 0,\n      offsetY: 0,\n      ...label,\n    };\n  }\n\n  protected getLabelOffset() {\n    return this.getLabelOffsetByDimAndFactor('y', -1);\n  }\n\n  protected getLabelItemAttrs(element: Element, index: number): TextStyle[] {\n    const { style, formatter } = this.options;\n    const mappingData: MappingDatum[] = get(element, 'model.mappingData', []);\n\n    return map(mappingData, (datum, datumIndex) => {\n      const value = this.getValue(datum);\n      return {\n        ...this.getPosition(datum),\n        text: formatter\n          ? formatter(\n              value,\n              {\n                [_ORIGIN]: datum._origin,\n                mappingDatum: datum,\n                mappingDatumIndex: datumIndex,\n                element,\n                elementIndex: index,\n              },\n              index\n            )\n          : value,\n        textAlign: 'center',\n        textBaseline: 'middle',\n        ...style,\n      };\n    });\n  }\n\n  protected getValue(datum: MappingDatum): number | undefined | null {\n    return get(datum._origin, this.layer.options.yField);\n  }\n\n  protected getPosition(datum: MappingDatum): { x: number; y: number } {\n    const pos = {\n      x: isArray(datum.x) ? last(datum.x) : datum.x,\n      y: isArray(datum.y) ? last(datum.y) : datum.y,\n    };\n    return pos;\n  }\n\n  protected adjustLabel() {\n    return;\n  }\n}\n\nregisterLabelComponent('point', PointLabel);\n"]}
{"version":3,"file":"connected-area.js","sourceRoot":"","sources":["../../src/components/connected-area.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * 区域连接组件，用于堆叠柱状图和堆叠条形图\n */\nimport { each, assign, mix, find } from '@antv/util';\nimport { IGroup, IShape, View } from '../dependents';\nimport { compare } from '../base/controller/state';\n\nfunction parsePoints(shape, coord) {\n  const parsedPoints = [];\n  const points = shape.get('origin').points;\n  each(points, (p) => {\n    parsedPoints.push(coord.convertPoint(p));\n  });\n  return parsedPoints;\n}\n\nfunction getDefaultStyle() {\n  return {\n    areaStyle: {\n      opacity: 0.2,\n    },\n    lineStyle: {\n      lineWidth: 2,\n      opacity: 0.1,\n    },\n  };\n}\n\nexport default class ConnectedArea {\n  private view: View;\n  private container: IGroup;\n  private field: string; // 堆叠字段\n  private areas: IShape[] = [];\n  private lines: IShape[] = [];\n  private areaStyle: any;\n  private _areaStyle: any = {};\n  private lineStyle: any;\n  private _lineStyle: any = {};\n  private triggerOn: string;\n  private animation: boolean;\n\n  constructor(cfg) {\n    assign(this, cfg);\n    this._init();\n  }\n\n  public draw() {\n    const groupedShapes = this._getGroupedShapes();\n    each(groupedShapes, (shapes, name) => {\n      if (shapes.length > 0) {\n        this._drawConnection(shapes, name);\n      }\n    });\n    if (this.triggerOn) {\n      this._addInteraction();\n    } else if (this.animation) {\n      // 如果定义了triggerOn的方式，则组件是响应交互的，初始化为不可见状态，因此无需动画\n      this._initialAnimation();\n    }\n  }\n  public clear() {\n    if (this.container) {\n      this.container.clear();\n    }\n    this.areas = [];\n    this.lines = [];\n  }\n\n  public destroy() {\n    if (this.container) {\n      this.container.remove();\n    }\n  }\n\n  public setState(state, condition) {\n    if (state === 'active') {\n      this._onActive(condition);\n    }\n    if (state === 'disabled') {\n      this._onDisabled(condition);\n    }\n    if (state === 'selected') {\n      this._onSelected(condition);\n    }\n  }\n\n  private _init() {\n    const layer = this.view.backgroundGroup;\n    this.container = layer.addGroup();\n    this.draw();\n    this.view.on('beforerender', () => {\n      this.clear();\n    });\n  }\n\n  private _getGroupedShapes() {\n    // 根据堆叠字段对shape进行分组\n    const { values } = this.view.getScaleByField(this.field);\n    const geometry = this.view.geometries[0];\n    const shapes = geometry.getShapes();\n    // 创建分组\n    const groups = {};\n    each(values, (v) => {\n      groups[v] = [];\n    });\n    // 执行分组\n    each(shapes, (shape) => {\n      const origin = shape.get('origin').data;\n      const key = origin[this.field];\n      groups[key].push(shape);\n    });\n    return groups;\n  }\n\n  private _drawConnection(shapes, name) {\n    // tslint:disable-next-line: prefer-for-of\n    const originColor = shapes[0].attr('fill');\n    this._areaStyle[name] = this._getShapeStyle(originColor, 'area');\n    this._lineStyle[name] = this._getShapeStyle(originColor, 'line');\n    const coord = this.view.geometries[0].coordinate;\n    for (let i = 0; i < shapes.length - 1; i++) {\n      const current = parsePoints(shapes[i], coord);\n      const next = parsePoints(shapes[i + 1], coord);\n      const areaStyle = mix({}, this._areaStyle[name]);\n      const lineStyle = mix({}, this._lineStyle[name]);\n      if (this.triggerOn) {\n        areaStyle.opacity = 0;\n        lineStyle.opacity = 0;\n      }\n      const area = this.container.addShape('path', {\n        attrs: mix({} as any, areaStyle, {\n          path: [\n            ['M', current[2].x, current[2].y],\n            ['L', next[1].x, next[1].y],\n            ['L', next[0].x, next[0].y],\n            ['L', current[3].x, current[3].y],\n          ],\n        }),\n        name: 'connectedArea',\n      });\n      const line = this.container.addShape('path', {\n        attrs: mix({} as any, lineStyle, {\n          path: [\n            ['M', current[2].x, current[2].y],\n            ['L', next[1].x, next[1].y],\n          ],\n          // stroke: shapes[i].attr('fill'),\n        }),\n        name: 'connectedArea',\n      });\n      // 在辅助图形上记录数据，用以交互和响应状态量\n      const originData = shapes[i].get('origin').data;\n      area.set('data', originData);\n      line.set('data', originData);\n      this.areas.push(area);\n      this.lines.push(line);\n    }\n  }\n\n  private _getShapeStyle(originColor, shapeType) {\n    const styleName = `${shapeType}Style`;\n    // 如果用户自己指定了样式，则不采用默认颜色映射\n    if (this[styleName]) {\n      return this[styleName];\n    }\n    const defaultStyle = getDefaultStyle()[styleName];\n    let mappedStyle: any = { fill: originColor };\n    if (shapeType === 'line') {\n      mappedStyle = { stroke: originColor };\n    }\n\n    return mix(defaultStyle, mappedStyle);\n  }\n\n  private _addInteraction() {\n    const eventName = this.triggerOn;\n    this.view.on(`interval:${eventName}`, (e) => {\n      const origin = e.target.get('origin').data[this.field];\n      this.setState('active', {\n        name: this.field,\n        exp: origin,\n      });\n      this.setState('disabled', {\n        name: this.field,\n        exp: (d) => {\n          return d !== origin;\n        },\n      });\n      this.view.canvas.draw();\n    });\n    // 当鼠标移动到其他区域时取消显示\n    this.view.on('mousemove', (e) => {\n      if (e.gEvent.target.get('name') !== 'interval') {\n        this.setState('disabled', {\n          name: this.field,\n          exp: () => {\n            return true;\n          },\n        });\n      }\n    });\n  }\n\n  private _initialAnimation() {\n    // clipIn动画\n    const { x, y, width, height } = this.view.coordinateBBox;\n    this.container.setClip({\n      type: 'rect',\n      attrs: {\n        x,\n        y,\n        width: 0,\n        height,\n      },\n    });\n    this.container.set('animating', true);\n    this.container.getClip().animate(\n      {\n        width,\n      },\n      600,\n      'easeQuadOut',\n      () => {}, // eslint-disable-line @typescript-eslint/no-empty-function\n      400\n    );\n  }\n\n  private _onActive(condition) {\n    each(this.areas, (area) => {\n      const shapeData = area.get('data');\n      const styleField = shapeData[this.field];\n      if (compare(shapeData, condition)) {\n        const opacity = this._areaStyle[styleField].opacity || 1;\n        // area.attr('opacity',this._areaStyle[styleField].opacity || 1);\n        area.stopAnimate();\n        area.animate({ opacity }, 400, 'easeQuadOut');\n      }\n    });\n    each(this.lines, (line) => {\n      const shapeData = line.get('data');\n      const styleField = shapeData[this.field];\n      if (compare(shapeData, condition)) {\n        const opacity = this._lineStyle[styleField].opacity || 1;\n        // line.attr('opacity',this._lineStyle[styleField].opacity || 1);\n        line.stopAnimate();\n        line.animate({ opacity }, 400, 'easeQuadOut');\n      }\n    });\n  }\n\n  private _onDisabled(condition) {\n    each(this.areas, (area) => {\n      const shapeData = area.get('data');\n      if (compare(shapeData, condition)) {\n        // area.attr('opacity',0);\n        area.stopAnimate();\n        area.animate(\n          {\n            opacity: 0,\n          },\n          400,\n          'easeQuadOut'\n        );\n      }\n    });\n    each(this.lines, (line) => {\n      const shapeData = line.get('data');\n      if (compare(shapeData, condition)) {\n        // line.attr('opacity',0);\n        line.stopAnimate();\n        line.animate(\n          {\n            opacity: 0,\n          },\n          400,\n          'easeQuadOut'\n        );\n      }\n    });\n  }\n\n  private _onSelected(condition) {\n    this._onActive(condition);\n  }\n\n  private getGeometry() {\n    return find(this.view.geometries, (geom) => geom.type === 'interval');\n  }\n}\n"]}
{"version":3,"file":"funnel-scale-in-y.js","sourceRoot":"","sources":["../../../../src/plots/funnel/animation/funnel-scale-in-y.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,MAAM,mBAAmB,CAAC;AAC9C,OAAO,EAAE,iBAAiB,EAAE,MAAM,UAAU,CAAC;AAE7C,SAAS,cAAc,CAAC,KAAK,EAAE,UAAU;IACjC,IAAA,qBAAuE,EAArE,gBAAc,EAAd,mCAAc,EAAE,gBAAK,EAAE,kBAAM,EAAE,sBAAQ,EAAE,oBAA4B,CAAC;IAE9E,IAAM,IAAI,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;IAC7B,IAAM,OAAO,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC5C,IAAM,OAAO,GAAG,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;IAEhD,IAAM,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC;QACzB,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE;YACL,CAAC,EAAE,IAAI,CAAC,CAAC;YACT,CAAC,EAAE,IAAI,CAAC,CAAC;YACT,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,MAAM,EAAE,IAAI,CAAC,MAAM;SACpB;KACF,CAAC,CAAC;IACH,IAAM,eAAe,GAAG;QACtB,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;KACpC,CAAC;IACF,IAAI,CAAC,SAAS,CACZ,SAAS,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE;QAC1B,CAAC,GAAG,EAAE,CAAC,OAAO,EAAE,CAAC,OAAO,CAAC;QACzB,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;QACX,CAAC,GAAG,EAAE,OAAO,EAAE,OAAO,CAAC;KACxB,CAAC,CACH,CAAC;IAEF,IAAM,gBAAgB,GAAG;QACvB,WAAW,EAAE,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC;QACtC,aAAa,EAAE,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC;QAC1C,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC;KAC/B,CAAC;IACF,KAAK,CAAC,IAAI,CAAC;QACT,WAAW,EAAE,CAAC;QACd,aAAa,EAAE,CAAC;QAChB,OAAO,EAAE,CAAC;KACX,CAAC,CAAC;IAEH,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE;QAC5B,QAAQ,EAAE,GAAG;QACb,MAAM,QAAA;QACN,QAAQ;YACN,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YACpB,IAAI,CAAC,MAAM,EAAE,CAAC;QAChB,CAAC;QACD,KAAK,OAAA;KACN,CAAC,CAAC;IAEH,KAAK,CAAC,OAAO,CAAC,gBAAgB,EAAE,EAAE,QAAQ,UAAA,EAAE,MAAM,QAAA,EAAE,KAAK,OAAA,EAAE,CAAC,CAAC;IAE7D,QAAQ,IAAI,UAAU,CAAC,cAAM,OAAA,QAAQ,CAAC,KAAK,CAAC,EAAf,CAAe,EAAE,QAAQ,GAAG,KAAK,CAAC,CAAC;AAClE,CAAC;AAED,cAAc,CAAC,aAAa,GAAG,gBAAgB,CAAC;AAChD,iBAAiB,CAAC,gBAAgB,EAAE,cAAc,CAAC,CAAC","sourcesContent":["import { transform } from '@antv/matrix-util';\nimport { registerAnimation } from '@antv/g2';\n\nfunction funnelScaleInY(shape, animateCfg) {\n  const { duration = 200, delay, easing, callback, reverse } = animateCfg || {};\n\n  const bbox = shape.getBBox();\n  const originX = (bbox.minX + bbox.maxX) / 2;\n  const originY = reverse ? bbox.maxY : bbox.minY;\n\n  const clip = shape.setClip({\n    type: 'rect',\n    attrs: {\n      x: bbox.x,\n      y: bbox.y,\n      width: bbox.width,\n      height: bbox.height,\n    },\n  });\n  const clipTargetAttrs = {\n    matrix: [1, 0, 0, 0, 1, 0, 0, 0, 1],\n  };\n  clip.setMatrix(\n    transform(clip.getMatrix(), [\n      ['t', -originX, -originY],\n      ['s', 1, 0],\n      ['t', originX, originY],\n    ])\n  );\n\n  const shapeTargetAttrs = {\n    fillOpacity: shape.attr('fillOpacity'),\n    strokeOpacity: shape.attr('strokeOpacity'),\n    opacity: shape.attr('opacity'),\n  };\n  shape.attr({\n    fillOpacity: 0,\n    strokeOpacity: 0,\n    opacity: 0,\n  });\n\n  clip.animate(clipTargetAttrs, {\n    duration: 200,\n    easing,\n    callback() {\n      shape.setClip(null);\n      clip.remove();\n    },\n    delay,\n  });\n\n  shape.animate(shapeTargetAttrs, { duration, easing, delay });\n\n  callback && setTimeout(() => callback(shape), duration + delay);\n}\n\nfunnelScaleInY.animationName = 'funnelScaleInY';\nregisterAnimation('funnelScaleInY', funnelScaleInY);\n"]}